# --
# AgentTicketZoomArticleFilterDialog.dtl - provides a dialog to filter articles
# Copyright (C) 2001-2009 OTRS AG, http://otrs.org/
# --
# $Id: AgentTicketZoomArticleFilterDialog.dtl,v 1.5 2009-11-27 11:52:30 mn Exp $
# --
# This software comes with ABSOLUTELY NO WARRANTY. For details, see
# the enclosed file COPYING for license information (AGPL). If you
# did not receive this file, see http://www.gnu.org/licenses/agpl.txt.
# --

# include AJAX lib
$Include{"AJAX"}

# use jquery lib
<script src="$Config{"Frontend::JavaScriptPath"}thirdparty/jquery/jquery.bgiframe.min.js" type="text/javascript"></script>
<script src="$Config{"Frontend::JavaScriptPath"}thirdparty/jquery/jquery.form.js" type="text/javascript"></script>
<script src="$Config{"Frontend::JavaScriptPath"}thirdparty/jquery/ui.dialog.min.js" type="text/javascript"></script>

<!-- UI CSS -->
<link rel="stylesheet" type="text/css" href="$Config{"Frontend::CSSPath"}overcast/jquery-ui.css">

<script type="text/javascript">
var ArticleFilterDialogCallback = function() {
    location.reload();
}

$(document).ready( function() {
    // Instantiate the Dialog
    $('#ArticleFilterDialog').dialog( {
        autoOpen:   false,
        bgiframe:   true,
        width:      350,
        modal:      true,
        draggable:  false,
        resizable:  false,
        buttons:    {
                        "$Text{"Reset"}":   function() {
                            document.getElementById('ArticleTypeFilter').selectedIndex = -1;
                            document.getElementById('ArticleSenderTypeFilter').selectedIndex = -1;
                        },
                        "$Text{"Save"}":    function() {
                            $('#ArticleFilterDialogForm').ajaxSubmit( ArticleFilterDialogCallback );
                        }
                    },
        title:      "$Text{"Article filter settings"}"
    } );

    // Add event listener to show dialog
    $('#SetArticleFilter').click(function() {
        $('#ArticleFilterDialog').dialog('open');
    });

    // Add event listener to reset filter settings
    $('#ResetArticleFilter').click(function() {
        var url = "$Env{"CGIHandle"}";
        var postdata = {
            Action:     'AgentTicketZoom',
            Subaction:  'ArticleFilterSet',
            TicketID:   '$QData{"TicketID"}'
        };
        AJAXFunctionCall( { Url: url, Callback: ArticleFilterDialogCallback, Data: postdata } );
    });
} );
</script>

<!-- filter dialog form-->
<div id="ArticleFilterDialog">
    <div class="bd">
        <form method="POST" id="ArticleFilterDialogForm" name="ArticleFilterDialogForm" action="$Env{"CGIHandle"}">
            <input type="hidden" value="AgentTicketZoom" name="Action"/>
            <input type="hidden" value="ArticleFilterSet" name="Subaction"/>
            <input type="hidden" value="$QData{"TicketID"}" name="TicketID"/>
            <table>
                <tr>
                    <td align="left" valign="top">
                        <label for="ArticleTypeFilter"><b>$Text{"Article"} $Text{"Type"}:</b></label>
                        $Data{"ArticleTypeFilterString"}
                    </td>
                    <td align="left" valign="top">
                        <label for="ArticleSenderTypeFilter"><b>$Text{"Article"} $Text{"Sender"} $Text{"Type"}:</b></label>
                        $Data{"ArticleSenderTypeFilterString"}
                    </td>
                </tr>
                <tr>
                    <td align="left" colspan="2">
                        <br/>
                        <label for="check">$Text{"Save filter settings as default"}:</label>
                        <input type="checkbox" name="SaveDefaults" value="1" />
                    </td>
                </tr>
            </table>
        </form>
    </div>
</div>
