# --
# AgentDashboard.dtl - provides HTML for global dashboard
# Copyright (C) 2001-2009 OTRS AG, http://otrs.org/
# --
# $Id: AgentDashboard.dtl,v 1.25 2009-12-14 16:27:11 martin Exp $
# --
# This software comes with ABSOLUTELY NO WARRANTY. For details, see
# the enclosed file COPYING for license information (AGPL). If you
# did not receive this file, see http://www.gnu.org/licenses/agpl.txt.
# --

# include AJAX lib
$Include{"AJAX"}

<script type="text/javascript">//<![CDATA[
var OTRSDashboard = {};

OTRSDashboard.PreferencesUpdate = function( Name, FormName ) {
    var ParamPart = '';
    var Form      = document.forms[FormName];
    for ( F = 0; F < Form.length; F++ ) {
        if ( Form[F] ) {
            var Param = Form[F].value;
            var ParamEncode = encodeURIComponent(Param);
            ParamPart = ParamPart + ';' + Form[F].name + '=' + ParamEncode;
        }
    }
    var url = OTRS.ConfigGet('Baselink') + ParamPart;
    var onLoaded = function() {
        OTRSUI.Settings( Name + '-setting', Name );
    };
    AJAXContentUpdate( Name, url, false, onLoaded );
    return true;
}
//]]></script>

<script type="text/javascript">//<![CDATA[
    $(function() {
        $("#sortable-large").sortable({
            placeholder: 'ui-state-highlight',
            forcePlaceholderSize: true,
            opacity: 0.6,
            cursor: 'move',
            update: function(event, ui) {
//                $('.ui-state-default').css("border","3px solid red");
                var url = '$Env{"Baselink"}Action=$Env{"Action"};Subaction=UpdatePosition';
                $('.ui-state-default').each(
                    function(i) {
//    alert( $(this).attr('id') );
                        url = url + ';Backend=' + $(this).attr('id');
                    }
                );
                AJAXContentUpdate('', url );
            }
        });
        $("#sortable-large").disableSelection();
        $("#sortable-small").sortable({
            placeholder: 'ui-state-highlight',
            forcePlaceholderSize: true,
            opacity: 0.6,
            cursor: 'move',
            update: function(event, ui) {
                var url = '$Env{"Baselink"}Action=$Env{"Action"};Subaction=UpdatePosition';
                $('.ui-state-default').each(
                    function(i) {
                        url = url + ';Backend=' + $(this).attr('id');
                    }
                );
                AJAXContentUpdate('', url );
            }
        });
        $("#sortable-small").disableSelection();
    });
//]]></script>

<!-- dtl:block:Content -->
<table border="0" width="100%" cellspacing="0" cellpadding="3">
    <tr>
        <td class="mainhead">
            $Env{"Box0"}$Text{"Dashboard"}$Env{"Box1"}
        </td>
    </tr>
    <tr>
        <td class="mainbody">

            <table width="100%" border="0">
                <tr>
                    <td valign="top">

                        <ul id="sortable-large">
<!-- dtl:block:ContentLarge -->
                            <li class="ui-state-default" id="Dashboard$QData{"Name"}-box">
                                <table border="0" width="100%" align="center" cellspacing="2" cellpadding="0">
                                    <tr>
                                        <td>

                                            <table border="0" width="100%" align="center" cellspacing="0" cellpadding="4">
                                                <tr class="contenthead">
                                                    <td title="$Text{"$QData{"Description"}"}">$Text{"$QData{"Title"}"}</td>
                                                    <td align="right">
<!-- dtl:block:ContentLargePreferences -->
                                                        <a href="#" onclick="OTRSUI.Settings('Dashboard$QData{"Name"}-setting', 'Dashboard$QData{"Name"}'); return false;" title="$Text{"Settings"}"><img border="0" src="$Config{"Frontend::ImagePath"}edit-setting.png" alt="$Text{"Settings"}"/></a>
<!-- dtl:block:ContentLargePreferences -->
                                                        <a href="$Env{"Baselink"}Action=$Env{"Action"};Subaction=UpdateRemove;Name=$LQData{"Name"}" title="$Text{"Close"}"><img border="0" src="$Config{"Frontend::ImagePath"}close.png" alt="$Text{"Close"}"/></a>
                                                    </td>
                                                </tr>
                                                <tr class="contentbody">
                                                    <td colspan="2">

                                                        <div id="Dashboard$QData{"Name"}-setting" style="display:none;">

                                                            <form action="$Env{"CGIHandle"}" method="post" enctype="multipart/form-data" name="Dashboard$QData{"NameForm"}_setting_form">
                                                                <input type="hidden" name="Action" value="$Env{"Action"}"/>
                                                                <input type="hidden" name="Subaction" value="UpdatePreferences"/>
                                                                <input type="hidden" name="Name" value="$QData{"Name"}"/>
                                                                <table>
<!-- dtl:block:ContentLargePreferencesItem -->
                                                                    <tr>
<!-- dtl:block:ContentLargePreferencesItemOption -->
                                                                        <td>$Text{"$QData{"Desc"}"}:</td>
                                                                        <td>$Data{"Option"}</td>
<!-- dtl:block:ContentLargePreferencesItemOption -->
<!-- dtl:block:ContentLargePreferencesItemInput -->
                                                                        <td>$Text{"$QData{"Desc"}"}:</td>
                                                                        <td><input type="text" size="$QData{"Size"}" name="$QData{"NamePref"}" value="$QData{"Data"}"/></td>
<!-- dtl:block:ContentLargePreferencesItemInput -->
<!-- dtl:block:ContentLargePreferencesItemTextArea -->
                                                                        <td>$Text{"$QData{"Desc"}"}:</td>
                                                                        <td><textarea rows="$QData{"Rows"}" cols="$Data{"Cols"}" name="$QData{"NamePref"}">$QData{"Data"}</textarea></td>
<!-- dtl:block:ContentLargePreferencesItemTextArea -->
                                                                    </tr>
<!-- dtl:block:ContentLargePreferencesItem -->
                                                                    <tr>
                                                                        <td colspan="2">
                                                                            <input class="button" type="submit" value="$Text{"Submit"}" onclick="OTRSDashboard.PreferencesUpdate('Dashboard$QData{"Name"}','Dashboard$QData{"NameForm"}_setting_form'); return false;"/>
                                                                            <input class="button" type="submit" value="$Text{"Cancel"}" onclick="OTRSUI.Settings('Dashboard$QData{"Name"}-setting', 'Dashboard$QData{"Name"}'); return false;"/>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </form>

                                                        </div>

                                                        <div id="Dashboard$QData{"Name"}">
                                                            $Data{"Content"}
                                                        </div>

                                                    </td>
                                                </tr>
                                                <tr class="contentfooter">
                                                    <td colspan="2">
                                                        &nbsp;
<!-- dtl:block:ContentLargeMore -->
                                                        <a href="$Data{"Link"}" title="$Text{"$Data{"LinkTitle"}"}" class="small">$Text{"more"} &#187;</a>
<!-- dtl:block:ContentLargeMore -->
                                                    </td>
                                                </tr>
                                            </table>

                                        </td>
                                    </tr>
                                </table>
                            </li>
<!-- dtl:block:ContentLarge -->
                        </ul>
                    </td>
                    <td width="340" valign="top">

                        <table border="0" width="100%" align="center" cellspacing="2" cellpadding="4">
                            <tr>
                                <td class="contenthead">

                                    <form action="$Env{"CGIHandle"}" method="post" enctype="multipart/form-data">
                                        <input type="hidden" name="Action" value="$Env{"Action"}"/>
                                        <input type="hidden" name="Subaction" value="UpdateSettings"/>

                                        <table border="0" width="100%" cellspacing="0" cellpadding="0">
                                            <tr onclick="OTRSUI.Accordion('setting', 'setting-expand-down', 'setting-collapse-up'); return false;">
                                                <td class="contenthead" width="99%">
                                                    $Text{"Settings"}
                                                </td>
                                                <td>
                                                    <div id="setting-expand-down"><a href="#" title="$Text{"Expand"}"><img border="0" src="$Config{"Frontend::ImagePath"}expand-down.png" alt="$Text{"Expand"}"/></a></div>
                                                    <div id="setting-collapse-up" style="display:none;"><a href="#" title="$Text{"Collapse"}"><img border="0" src="$Config{"Frontend::ImagePath"}collapse-up.png" alt="$Text{"Collapse"}"/></a></div>
                                                </td>
                                            </tr>
                                        </table>

                                        <div id="setting" style="display:none;" class="contenthead">

                                            <table border="0" width="100%" cellspacing="4" cellpadding="4" class="contentbody">
<!-- dtl:block:ContentSettings -->
                                                <tr>
                                                    <td>
                                                        <div title="$Text{"$QData{"Description"}"}">
                                                            <input type="checkbox" name="Backend" value="$QData{"Name"}" $Data{"Checked"}/>
                                                            $Text{"$QData{"Title"}"}
                                                        </div>
                                                    </td>
                                                </tr>
<!-- dtl:block:ContentSettings -->
                                                <tr>
                                                    <td>
                                                        <input class="button" accesskey="g" type="submit" value="$Text{"Save"}"/>
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>

                                    </form>

                                </td>
                            </tr>
                        </table>

                        <hr/>

                        <ul id="sortable-small">
<!-- dtl:block:ContentSmall -->
                            <li class="ui-state-default" id="Dashboard$QData{"Name"}-box">
                                <table border="0" width="100%" align="center" cellspacing="2" cellpadding="0">
                                    <tr>
                                        <td>

                                            <table border="0" width="100%" align="center" cellspacing="0" cellpadding="4">
                                                <tr class="contenthead">
                                                    <td title="$Text{"$QData{"Description"}"}">$Text{"$QData{"Title"}"}</td>
                                                    <td align="right">
<!-- dtl:block:ContentSmallPreferences -->
                                                        <a href="#" onclick="OTRSUI.Settings('Dashboard$QData{"Name"}-setting', 'Dashboard$QData{"Name"}'); return false;" title="$Text{"Settings"}"><img border="0" src="$Config{"Frontend::ImagePath"}edit-setting.png" alt="$Text{"Settings"}"/></a>
<!-- dtl:block:ContentSmallPreferences -->
                                                        <a href="$Env{"Baselink"}Action=$Env{"Action"};Subaction=UpdateRemove;Name=$LQData{"Name"}" title="$Text{"Close"}"><img border="0" src="$Config{"Frontend::ImagePath"}close.png" alt="$Text{"Close"}" /></a>
                                                    </td>
                                                </tr>
                                                <tr class="contentbody">
                                                    <td colspan="2">

                                                        <div id="Dashboard$QData{"Name"}-setting" style="display:none;">

                                                            <form action="$Env{"CGIHandle"}" method="post" enctype="multipart/form-data" name="Dashboard$QData{"NameForm"}_setting_form">
                                                                <input type="hidden" name="Action" value="$Env{"Action"}"/>
                                                                <input type="hidden" name="Subaction" value="UpdatePreferences"/>
                                                                <input type="hidden" name="Name" value="$QData{"Name"}"/>
                                                                <table>
<!-- dtl:block:ContentSmallPreferencesItem -->
                                                                    <tr>
<!-- dtl:block:ContentSmallPreferencesItemOption -->
                                                                        <td>$Text{"$QData{"Desc"}"}:</td>
                                                                        <td>$Data{"Option"}</td>
<!-- dtl:block:ContentSmallPreferencesItemOption -->
<!-- dtl:block:ContentSmallPreferencesItemInput -->
                                                                        <td>$Text{"$QData{"Desc"}"}:</td>
                                                                        <td><input type="text" size="$QData{"Size"}" name="$QData{"NamePref"}" value="$QData{"Data"}"/></td>
<!-- dtl:block:ContentSmallPreferencesItemInput -->
<!-- dtl:block:ContentSmallPreferencesItemTextArea -->
                                                                        <td>$Text{"$QData{"Desc"}"}:</td>
                                                                        <td><textarea rows="$QData{"Rows"}" cols="$Data{"Cols"}" name="$QData{"NamePref"}">$QData{"Data"}</textarea></td>
<!-- dtl:block:ContentSmallPreferencesItemTextArea -->
                                                                    </tr>
<!-- dtl:block:ContentSmallPreferencesItem -->
                                                                    <tr>
                                                                        <td colspan="2">
                                                                            <input class="button" type="submit" value="$Text{"Submit"}" onclick="OTRSDashboard.PreferencesUpdate('Dashboard$QData{"Name"}','Dashboard$QData{"NameForm"}_setting_form'); return false;"/>
                                                                            <input class="button" type="submit" value="$Text{"Cancel"}" onclick="OTRSUI.Settings('Dashboard$QData{"Name"}-setting', 'Dashboard$QData{"Name"}'); return false;"/>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </form>

                                                        </div>

                                                        <div id="Dashboard$QData{"Name"}">
                                                            $Data{"Content"}
                                                        </div>

                                                    </td>
                                                </tr>
                                                <tr class="contentfooter">
                                                    <td colspan="2">
                                                        &nbsp;
<!-- dtl:block:ContentSmallMore -->
                                                        <a href="$Data{"Link"}" title="$Text{"$Data{"LinkTitle"}"}" class="small">$Text{"more"} &#187;</a>
<!-- dtl:block:ContentSmallMore -->
                                                    </td>
                                                </tr>
                                            </table>

                                        </td>
                                    </tr>
                                </table>
                            </li>
<!-- dtl:block:ContentSmall -->
                        </ul>

                    </td>
                </tr>
            </table>

        </td>
    </tr>
</table>
<!-- dtl:block:Content -->
